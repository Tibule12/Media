import{_ as c,h as d,o as i,c as n,a as s,t as l,F as p,j as u,g as m,f as k,v as y,e as g,d as h}from"./index-b19461a9.js";const w={props:["id"],data(){return{post:null,newComment:"",liked:!1}},async created(){await this.fetchPost()},methods:{async fetchPost(){try{const r=await d.get(`/api/posts/${this.id}/`);this.post=r.data,this.liked=this.post.likes.some(t=>t.user.username===this.$root.$data.username)}catch(r){console.error("Failed to load post",r)}},async toggleLike(){try{const r=await d.post(`/api/posts/${this.id}/like/`);this.liked=!this.liked,await this.fetchPost()}catch(r){console.error("Failed to toggle like",r)}},async addComment(){try{await d.post("/api/comments/",{post:this.id,content:this.newComment}),this.newComment="",await this.fetchPost()}catch(r){console.error("Failed to add comment",r)}}}},v={key:0},f={key:0},x=["src"],C={key:1,controls:"",style:{"max-width":"100%","max-height":"400px"}},_=["src","type"],P={key:1};function L(r,t,b,D,o,a){return i(),n("div",null,[t[7]||(t[7]=s("h2",null,"Post Detail",-1)),o.post?(i(),n("div",v,[s("h3",null,l(o.post.author.username),1),s("p",null,l(o.post.content),1),o.post.media&&o.post.media.length?(i(),n("div",f,[t[4]||(t[4]=s("h4",null,"Media",-1)),(i(!0),n(p,null,u(o.post.media,e=>(i(),n("div",{key:e.id,class:"media-item"},[e.type.startsWith("image/")?(i(),n("img",{key:0,src:e.url,alt:"Post media",style:{"max-width":"100%","max-height":"400px"}},null,8,x)):e.type.startsWith("video/")?(i(),n("video",C,[s("source",{src:e.url,type:e.type},null,8,_),t[3]||(t[3]=h(" Your browser does not support the video tag. "))])):m("",!0)]))),128))])):m("",!0),s("p",null,"Likes: "+l(o.post.likes.length),1),s("button",{onClick:t[0]||(t[0]=(...e)=>a.toggleLike&&a.toggleLike(...e))},l(o.liked?"Unlike":"Like"),1),t[6]||(t[6]=s("h4",null,"Comments",-1)),(i(!0),n(p,null,u(o.post.comments,e=>(i(),n("div",{key:e.id,class:"comment"},[s("p",null,[s("strong",null,l(e.author.username)+":",1),h(" "+l(e.content),1)])]))),128)),s("form",{onSubmit:t[2]||(t[2]=g((...e)=>a.addComment&&a.addComment(...e),["prevent"]))},[k(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.newComment=e),placeholder:"Add a comment",required:""},null,512),[[y,o.newComment]]),t[5]||(t[5]=s("button",{type:"submit"},"Comment",-1))],32)])):(i(),n("div",P,"Loading..."))])}const V=c(w,[["render",L]]);export{V as default};
